# Project Inventory - Next.js OpenAI Doc Search + LandingAI OCR

**Project**: Next.js OpenAI Document Search with Semantic Search & OCR
**Stack**: Next.js 13, TypeScript, Supabase (pgvector), OpenAI, LandingAI
**Database**: Supabase PostgreSQL with pgvector extension
**Deployment**: Vercel + Supabase Cloud

---

## 📁 Project Structure Overview

```
nextjs-openai-doc-search-starter/
├── 📄 Configuration Files
├── 🔧 Core Application
├── 🎨 UI Components
├── 📚 Documentation
├── 🗃️ Database
└── 🚀 Deployment
```

---

## 📄 Configuration Files

### Package & Dependencies
| File | Purpose | Key Dependencies |
|------|---------|------------------|
| `package.json` | Project dependencies and scripts | Next.js, React, Supabase, OpenAI, Tailwind |
| `pnpm-lock.yaml` | Locked dependency versions | Auto-generated |
| `tsconfig.json` | TypeScript configuration | Strict mode, path aliases |
| `.eslintrc.json` | Code linting rules | Next.js ESLint config |
| `.gitignore` | Git exclusions | node_modules, .env, .next |

### Styling & Build
| File | Purpose | Configuration |
|------|---------|---------------|
| `tailwind.config.js` | Tailwind CSS configuration | Custom colors, animations |
| `postcss.config.js` | PostCSS plugins | Tailwind, autoprefixer |
| `next.config.js` | Next.js build configuration | React strict mode |

### Environment & Secrets
| File | Purpose | Contents |
|------|---------|----------|
| `.env` | Local environment variables | Supabase, OpenAI, LandingAI keys |
| `.env.local` | Vercel-pulled variables | Deployment-specific config |
| `.env.example` | Environment template | Key names without values |
| `.env.vercel` | Vercel deployment config | Auto-generated by Vercel CLI |

---

## 🔧 Core Application Files

### Entry Points & Layout
| File | Purpose | Features |
|------|---------|----------|
| `pages/_app.tsx` | Next.js app wrapper | Global styles, providers |
| `pages/_document.tsx` | HTML document structure | Meta tags, lang attributes |
| `pages/index.tsx` | Homepage | Landing page with search |

### API Routes
| File | Endpoint | Purpose | Integration |
|------|----------|---------|-------------|
| `pages/api/vector-search.ts` | `/api/vector-search` | Semantic search with OpenAI embeddings | OpenAI + Supabase pgvector |
| `pages/api/ocr.ts` | `/api/ocr` | Document OCR extraction | **NEW: LandingAI ADE API** |

---

## 📚 Library Files (`lib/`)

### Core Utilities
| File | Purpose | Key Functions | Dependencies |
|------|---------|---------------|--------------|
| `lib/generate-embeddings.ts` | Generate OpenAI embeddings from MDX files | `generateEmbeddings()`, MDX parsing, checksum validation | OpenAI, Supabase, mdast |
| `lib/landingai.ts` | **NEW: LandingAI OCR client** | `LandingAIClient`, `parseDocument()`, `extractText()` | LandingAI ADE API |
| `lib/utils.ts` | Shared utilities | `cn()` for class merging | clsx, tailwind-merge |
| `lib/errors.ts` | Error handling | ApplicationError classes | - |

### Data Flow
```
MDX Files → generate-embeddings.ts → OpenAI API → Supabase (pgvector)
PDF/Images → ocr.ts → LandingAI API → Text Extraction
User Query → vector-search.ts → OpenAI Embeddings → Similarity Search → Results
```

---

## 🎨 UI Components

### Search & Interaction
| File | Component | Purpose | Features |
|------|-----------|---------|----------|
| `components/SearchDialog.tsx` | `<SearchDialog />` | Semantic search modal | Cmd+K shortcut, real-time search, streaming responses |
| `components/DocumentUpload.tsx` | `<DocumentUpload />` | **NEW: OCR document upload** | PDF/image upload, text extraction preview |

### UI Primitives (`components/ui/`)
| File | Component | Library | Purpose |
|------|-----------|---------|----------|
| `ui/dialog.tsx` | `<Dialog />` | Radix UI | Accessible modal dialogs |
| `ui/command.tsx` | `<Command />` | cmdk | Command palette interface |
| `ui/button.tsx` | `<Button />` | CVA | Styled button variants |
| `ui/input.tsx` | `<Input />` | - | Text input field |
| `ui/label.tsx` | `<Label />` | Radix UI | Accessible form labels |

---

## 🗃️ Database (`supabase/`)

### Schema & Migrations
| File | Purpose | Contents |
|------|---------|----------|
| `migrations/20230406025118_init.sql` | Initial database schema | Tables, functions, pgvector setup |
| `seed.sql` | Sample data (optional) | Test data for development |

### Database Tables
| Table | Purpose | Key Columns |
|-------|---------|-------------|
| `nods_page` | Documentation pages | `id`, `path`, `checksum`, `meta`, `parent_page_id` |
| `nods_page_section` | Page sections with embeddings | `id`, `page_id`, `content`, `embedding (vector[1536])`, `token_count` |

### Database Functions
| Function | Purpose | Parameters |
|----------|---------|------------|
| `match_page_sections()` | Vector similarity search | `embedding`, `match_threshold`, `match_count`, `min_content_length` |
| `get_page_parents()` | Recursive parent page lookup | `page_id` |

---

## 📚 Documentation

### Project Documentation
| File | Purpose | Audience |
|------|---------|----------|
| `README.md` | Project overview & quick start | Developers, contributors |
| `PROJECT_STRUCTURE.md` | Original structure documentation | Developers |
| `SETUP_COMPLETE.md` | Setup completion status | **NEW: Setup guide** |
| `LANDINGAI_INTEGRATION.md` | **NEW: LandingAI OCR guide** | Developers using OCR |
| `PROJECT_INVENTORY.md` | **NEW: Complete file inventory** | **THIS FILE** |
| `LICENSE` | Apache 2.0 license | Legal |

---

## 🚀 Deployment Files

### Vercel Configuration
| File/Folder | Purpose | Contents |
|-------------|---------|----------|
| `.vercel/` | Vercel deployment cache | Project metadata, deployment history |
| `.env.vercel` | Vercel environment snapshot | Auto-pulled environment variables |

---

## 📊 Project Statistics

### File Counts
- **Total Source Files**: 24
- **TypeScript/TSX**: 15
- **Configuration**: 6
- **Documentation**: 7
- **SQL Migrations**: 2

### Lines of Code (Estimated)
- **Application Code**: ~2,500 lines
- **Components**: ~800 lines
- **API Routes**: ~400 lines
- **Library Code**: ~1,200 lines
- **Tests**: 0 (opportunity for contribution)

### Dependencies
- **Production**: 33 packages
- **Development**: 10 packages
- **Total Package Size**: ~150MB (node_modules)

---

## 🔑 Environment Variables Inventory

### Required Variables
| Variable | Source | Purpose | Environments |
|----------|--------|---------|--------------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase Dashboard | Public Supabase project URL | All |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase Dashboard | Public anon key (browser) | All |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase Dashboard | Service role key (server) | All |
| `OPENAI_KEY` | OpenAI Platform | OpenAI API key | All |
| `LANDINGAI_API_KEY` | **NEW: LandingAI VA** | LandingAI OCR API key | All |
| `LANDINGAI_API_ENDPOINT` | **NEW: Optional** | LandingAI region endpoint | All |

### Vercel Deployment Variables
| Variable | Purpose | Auto-Set |
|----------|---------|----------|
| `VERCEL_OIDC_TOKEN` | Vercel authentication | ✅ |
| `bucket_*` | Supabase integration metadata | ✅ |

---

## 🆕 New Features Added

### LandingAI OCR Integration
- **Client Library**: `lib/landingai.ts` (150 lines)
- **API Endpoint**: `pages/api/ocr.ts` (100 lines)
- **UI Component**: `components/DocumentUpload.tsx` (80 lines)
- **Documentation**: `LANDINGAI_INTEGRATION.md` (250 lines)
- **Environment**: `LANDINGAI_API_KEY`, `LANDINGAI_API_ENDPOINT`

### Enhanced Documentation
- **Setup Guide**: `SETUP_COMPLETE.md`
- **Project Inventory**: `PROJECT_INVENTORY.md` (this file)

---

## 🔄 Data Flow Summary

### Embedding Generation (Build Time)
```
.mdx files → lib/generate-embeddings.ts
           → OpenAI Embeddings API
           → Supabase (nods_page, nods_page_section)
```

### Semantic Search (Runtime)
```
User Query → /api/vector-search
           → OpenAI Embeddings API
           → Supabase match_page_sections()
           → OpenAI Chat Completion
           → Streaming Response
```

### OCR Processing (Runtime) **NEW**
```
PDF/Image → /api/ocr
          → LandingAI ADE API
          → Parsed Document (markdown, chunks, metadata)
          → Response to Client
```

---

## 🛠️ Development Commands

### Core Scripts
```bash
pnpm dev              # Start development server (port 3001)
pnpm build            # Build for production (includes embeddings)
pnpm start            # Start production server
pnpm lint             # Run ESLint
pnpm format           # Format with Prettier
```

### Embeddings
```bash
pnpm run embeddings          # Generate embeddings from .mdx files
pnpm run embeddings:refresh  # Force regenerate all embeddings
```

### Deployment
```bash
vercel               # Deploy to preview
vercel --prod        # Deploy to production
vercel env pull      # Pull environment variables
```

---

## 🎯 Next Steps & Opportunities

### Testing (Not Implemented)
- [ ] Unit tests for components
- [ ] Integration tests for API routes
- [ ] E2E tests with Playwright
- [ ] OCR integration tests

### Documentation
- [ ] API reference documentation
- [ ] Component storybook
- [ ] Architecture diagrams
- [ ] Contributing guidelines

### Features
- [ ] Multi-language support
- [ ] Advanced search filters
- [ ] Document version history
- [ ] Analytics & usage tracking

---

## 📞 Support & Resources

- **Supabase Dashboard**: https://app.supabase.com/project/xkxyvboeubffxxbebsll
- **Vercel Project**: https://vercel.com/jake-tolentinos-projects-c0369c83/nextjs-openai-doc-search-starter
- **OpenAI Platform**: https://platform.openai.com
- **LandingAI Platform**: https://va.landing.ai
- **GitHub Repository**: https://github.com/jgtolentino/nextjs-openai-doc-search-starter

---

**Last Updated**: 2025-10-06
**Version**: 1.0.0 (with LandingAI OCR)
